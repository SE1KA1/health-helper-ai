<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>å…»ç”Ÿå°åŠ©æ‰‹</title>
  <style>
    :root{
      --bg1: #f6fffb;
      --bg2: #e9fff2;
      --accent: #2d9c6a;
      --muted: #6b7280;
      --card: #ffffff;
      --radius: 14px;
      --glass: rgba(255,255,255,0.7);
      font-family: "Helvetica Neue", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg1),var(--bg2));-webkit-font-smoothing:antialiased}
    .wrap{max-width:100%;margin:0 auto;padding:12px}
    .card{background:var(--card);border-radius:18px;box-shadow:0 10px 40px rgba(20,30,20,0.08);overflow:hidden;position:relative}

    /* èƒŒæ™¯è£…é¥°ï¼šè½»ç›ˆå¶å­ SVG å±‚ */
    .decor{position:absolute;right:0;top:0;bottom:0;width:320px;pointer-events:none;opacity:0.12;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="320" height="640"><g fill="none" stroke="%232d9c6a" stroke-width="1.5"><path d="M20 120c40-40 110-40 140 0s80 60 120 40"/><path d="M40 240c30-60 120-80 170-20s80 120 40 160"/><path d="M10 420c60-80 160-100 220-40s40 140-40 180"/></g></svg>');background-repeat:no-repeat;background-position:right top}

    header{display:flex;align-items:center;padding:18px 24px;border-bottom:1px solid rgba(16,24,16,0.04);background:linear-gradient(90deg,#e9fff2,#f6fffb)}
    /* ä½¿ç”¨å†…è” SVG ä½œä¸ºå¤´åƒï¼Œé¿å…å¤–éƒ¨é“¾æ¥å¤±æ•ˆ */
    .logo{width:72px;height:72px;border-radius:50%;display:inline-block;flex-shrink:0;margin-right:16px;border:3px solid #c8f7d8;overflow:hidden;background:#fff}
    .logo svg{width:100%;height:100%;display:block}

    header h1{margin:0;font-size:20px;color:#0f5132}
    header p{margin:6px 0 0 0;color:var(--muted);font-size:13px}
    .tagline{margin-left:auto;font-size:13px;color:#4e8f6a}

    .banner{display:flex;align-items:center;gap:16px;padding:18px;border-bottom:1px solid rgba(16,24,16,0.04);background:linear-gradient(90deg,rgba(237,252,240,0.8),rgba(255,255,255,0.6))}
    .banner .art{width:120px;height:80px;border-radius:12px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 120"><defs><linearGradient id="g" x1="0" x2="1"><stop offset="0" stop-color="%23e9fff2"/><stop offset="1" stop-color="%23ffffff"/></linearGradient></defs><rect width="200" height="120" rx="12" fill="url(%23g)"/><g transform="translate(20,15)" fill="none" stroke="%232d9c6a" stroke-width="2"><path d="M0 60 C20 10,60 10,80 60 C100 110,140 110,160 60"/></g></svg>');background-size:cover}
    .banner .lead{font-size:16px;color:#0f5132;font-weight:600}
    .banner .sub{font-size:13px;color:var(--muted)}

    .main{display:flex;gap:20px;padding:18px}
    .panel{flex:1;min-height:420px;display:flex;flex-direction:column}

    /* èŠå¤©åŒº */
    .chat-area{flex:1;padding:16px;display:flex;flex-direction:column;gap:12px;overflow:auto;background:linear-gradient(180deg, rgba(245,255,250,0.6), rgba(250,255,252,0.6));border-radius:12px}
    .msg-row{display:flex;align-items:flex-end;gap:10px}
    .msg{max-width:76%;padding:12px 14px;border-radius:14px;line-height:1.5;box-shadow:0 4px 12px rgba(10,20,10,0.03)}
    .msg.user{margin-left:auto;background:linear-gradient(90deg,#e6ffef,#d9ffea);color:#064925;border-bottom-right-radius:6px}
    .msg.bot{margin-right:auto;background:linear-gradient(90deg,#fff,#fbfffb);border:1px solid rgba(40,120,80,0.06);color:#0b3d2a;border-bottom-left-radius:6px;display:inline-block}
    .avatar{width:40px;height:40px;border-radius:50%;flex-shrink:0;overflow:hidden;border:2px solid rgba(255,255,255,0.8);background:#fff}
    .avatar svg{width:100%;height:100%;display:block}
    .meta{font-size:12px;color:var(--muted);margin-top:6px}

    /* è¾“å…¥åŒº */
    .composer{display:flex;gap:10px;padding-top:14px}
    .input{flex:1;display:flex;align-items:center;background:linear-gradient(180deg,#ffffff,#f9fff8);padding:10px;border-radius:12px;border:1px solid rgba(34,139,86,0.06)}
    .input input{flex:1;border:0;outline:none;font-size:15px;background:transparent;padding:4px}
    .send-btn{background:var(--accent);border:none;color:white;padding:10px 16px;border-radius:10px;font-weight:600;cursor:pointer}
    .send-btn:disabled{opacity:0.6;cursor:not-allowed}

    /* ä¾§æ  */
    .sidebar{width:320px;padding:14px;border-left:1px solid rgba(16,24,16,0.04);background:linear-gradient(180deg,#f7fff6,#ffffff)}
    .card-title{font-weight:700;color:#0f5132;margin-bottom:8px}
    .hint{font-size:13px;color:var(--muted);line-height:1.6}
    .chips{display:flex;gap:6px;flex-wrap:wrap;margin-top:12px}
    .chip{background:#f1fff4;padding:8px 10px;border-radius:999px;border:1px solid rgba(47,120,71,0.06);font-size:13px;color:#15592b;cursor:pointer}

    /* æ¯æ—¥ä¸€å¥æ ·å¼ */
    .daily{margin-top:18px;padding:12px;border-radius:12px;background:linear-gradient(180deg,#fff,#f8fffa);border:1px solid rgba(40,120,80,0.04)}
    .daily p{margin:0;font-size:14px;color:#15592b}
    .daily .tag{font-size:12px;color:var(--muted);margin-top:6px}

    /* å°å±è‡ªé€‚åº” */
    @media (max-width:880px){
      .main{flex-direction:column;padding:12px}
      .sidebar{width:100%;border-left:0;border-top:1px solid rgba(16,24,16,0.04);padding:10px}
      .banner{flex-direction:column;align-items:flex-start}
      .decor{display:none}
      .avatar{width:36px;height:36px}
      .logo{width:56px;height:56px}
      .send-btn{width:100%}
      .composer{flex-direction:column}
    }

    /* typing åŠ¨ç”» */
    .typing{display:inline-block;height:8px;width:40px;position:relative}
    .dot{width:8px;height:8px;border-radius:50%;background:#9adcb5;display:inline-block;margin-right:6px;animation:blink 1s infinite}
    .dot:nth-child(2){animation-delay:0.15s}
    .dot:nth-child(3){animation-delay:0.3s}
    @keyframes blink{0%{opacity:.2;transform:translateY(0)}50%{opacity:1;transform:translateY(-4px)}100%{opacity:.2;transform:translateY(0)}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">

      <div class="decor" aria-hidden="true"></div>

      <header>
        <div class="logo" aria-hidden="true">
          <!-- å†…è” SVGï¼šæ¸©æŸ”äº²åˆ‡çš„å¥³å­©å¤´åƒï¼ˆç®€æ´é£æ ¼ï¼Œä¿è¯æ°¸ä¸å¤±æ•ˆï¼‰ -->
          <svg viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="å°åŠ©æ‰‹å¤´åƒ">
            <defs>
              <linearGradient id="g1" x1="0" x2="1"><stop offset="0" stop-color="#fff"/><stop offset="1" stop-color="#f3fff4"/></linearGradient>
            </defs>
            <rect width="120" height="120" rx="60" fill="url(#g1)"/>
            <!-- å¤´å‘ -->
            <path d="M30 60c0-22 20-28 34-28s34 6 34 28v12c0 14-12 26-34 26s-34-12-34-26z" fill="#f7d9c9"/>
            <!-- è„¸ -->
            <circle cx="60" cy="60" r="26" fill="#ffeedf"/>
            <!-- çœ¼ç› -->
            <ellipse cx="50" cy="62" rx="3" ry="2" fill="#2d2d2d"/>
            <ellipse cx="70" cy="62" rx="3" ry="2" fill="#2d2d2d"/>
            <!-- å¾®ç¬‘ -->
            <path d="M50 72c4 4 16 4 20 0" stroke="#2d2d2d" stroke-width="2" fill="none" stroke-linecap="round"/>
            <!-- è¡£é¢† -->
            <path d="M44 86c8 6 24 6 32 0" stroke="#d8f0de" stroke-width="6" stroke-linecap="round"/>
          </svg>
        </div>

        <div>
          <h1>å…»ç”Ÿå°åŠ©æ‰‹ AI</h1>
          <p>å‘Šè¯‰æˆ‘ä½ çš„å¥åº·å›°æ‰°æˆ–ä¸è‰¯ä¹ æƒ¯ï¼ˆå¦‚ï¼šç†¬å¤œã€ä¹…åã€æŠ½çƒŸï¼‰â€” æˆ‘ä¼šç»™å‡ºå¯è¡Œçš„å…»ç”Ÿå»ºè®®ã€‚</p>
        </div>
        <div class="tagline">ğŸŒ¿ èº«å¿ƒå’Œè° Â· å¥åº·ç›¸ä¼´</div>
      </header>

      <div class="banner">
        <div class="art" aria-hidden="true"></div>
        <div>
          <div class="lead">æ¯å¤©ä¸€ç‚¹å°æ”¹å˜ï¼Œå¥åº·å¸¸ä¼´ä½ å·¦å³</div>
          <div class="sub">ç§‘å­¦å»ºè®® Â· æ¸©æŸ”æé†’ Â· å¯æ‰§è¡Œçš„ç”Ÿæ´»ä¹ æƒ¯æ”¹å–„æ–¹æ¡ˆ</div>
        </div>
      </div>

      <div class="main">
        <div class="panel">
          <div id="chat" class="chat-area" aria-live="polite"></div>

          <div class="composer">
            <div class="input" role="search">
              <input id="input" placeholder="è¾“å…¥å¥åº·é—®é¢˜æˆ–ä¸è‰¯ä¹ æƒ¯ï¼ŒæŒ‰å›è½¦å‘é€..." aria-label="è¾“å…¥æ‚¨çš„é—®é¢˜" />
            </div>
            <button id="send" class="send-btn">å‘é€</button>
          </div>
        </div>

        <aside class="sidebar">
          <div class="card-title">å¿«é€Ÿç¤ºä¾‹</div>
          <div class="hint">è¯•è¯•ä¸‹é¢çš„å¥å­ï¼Œç‚¹å‡»å³å¯å¡«å…¥å¹¶å‘é€ï¼š</div>
          <div class="chips" id="chips">
            <div class="chip">æ¯å¤©ç†¬å¤œåˆ°å‡Œæ™¨1ç‚¹</div>
            <div class="chip">æˆ‘æŠ½çƒŸä¸€å¤©ä¸€åŒ…</div>
            <div class="chip">ä¹…åå·¥ä½œè…°é…¸èƒŒç—›</div>
            <div class="chip">ç¡çœ è´¨é‡å·®ï¼Œå®¹æ˜“å¤±çœ </div>
            <div class="chip">æ€»æ˜¯èƒƒèƒ€ï¼Œé¥­åä¸èˆ’æœ</div>
          </div>

          <div class="daily">
            <div class="card-title">æ¯æ—¥å…»ç”Ÿä¸€å¥</div>
            <p id="daily-quote">â€”â€” æ¬¢è¿ï¼è¿™æ˜¯ä½ ä»Šæ—¥çš„å…»ç”Ÿå°æé†’ â€”â€”</p>
            <div class="tag">æ¯å¤©ä¸€å°å¥ï¼Œæ¸©æŸ”æé†’ä½ æ³¨æ„å¥åº·</div>
            <button id="new-quote" style="margin-top:10px;padding:8px 10px;border-radius:8px;border:none;background:#e9fff2;color:#186b3f;cursor:pointer">æ¢ä¸€å¥</button>
          </div>

          <div style="margin-top:18px">
            <div class="card-title">è¯´æ˜</div>
            <div class="hint">é¡µé¢å†…ç½®â€œå‰ç«¯è§„åˆ™å»ºè®®â€ä½œä¸ºç¦»çº¿å…œåº•ï¼›è‹¥è¦ä½¿ç”¨ä½ ä¸Šä¼ çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œè¯·éƒ¨ç½²åç«¯ APIï¼ˆç¤ºä¾‹è§ç”»å¸ƒä¸­çš„ server.pyï¼‰ï¼Œå¹¶ä¿è¯å‰ç«¯èƒ½è®¿é—® <code>http://localhost:5000/api/advice</code>ã€‚</div>
          </div>
        </aside>
      </div>
    </div>
  </div>

<script>
// DOM
const chat = document.getElementById('chat');
const input = document.getElementById('input');
const sendBtn = document.getElementById('send');
const chips = document.getElementById('chips');

// æ¯æ—¥ä¸€å¥æ•°æ®
const QUOTES = [
  'è§„å¾‹ä½œæ¯æ¯”ä»»ä½•ç¥å¥‡è¡¥å“éƒ½æ›´ç®¡ç”¨ï¼šæ¯å¤©å°½é‡åœ¨å›ºå®šæ—¶é—´ç¡è§‰ä¸èµ·åºŠã€‚',
  'ä¹…åä¸€å°æ—¶ï¼Œç«™èµ·æ¥æ´»åŠ¨5åˆ†é’Ÿï¼Œä¼¸å±•å¹¶å–ä¸€å°æ¯æ°´ã€‚',
  'é¥­åæ•£æ­¥10-20åˆ†é’Ÿï¼Œæœ‰åŠ©äºæ¶ˆåŒ–ä¸è¡€ç³–ç¨³å®šã€‚',
  'ä¿æŒæ¯å¤©è‡³å°‘30åˆ†é’Ÿä¸­ç­‰å¼ºåº¦è¿åŠ¨ï¼Œèƒ½æ˜¾è‘—æå‡å¿ƒæƒ…ä¸ç¡çœ è´¨é‡ã€‚',
  'å°‘åƒåŠ å·¥é£Ÿå“ä¸é«˜ç³–é¥®æ–™ï¼Œå¤šåƒè”¬æœä¸å…¨è°·ç‰©ã€‚',
  'ç¡å‰ä¸€å°æ—¶è¿œç¦»æ‰‹æœºä¸å¼ºå…‰ï¼Œåšä¸€æœ¬è½»æ¾çš„ä¹¦æˆ–æ·±å‘¼å¸ã€‚'
];
function showRandomQuote(){
  const q = QUOTES[Math.floor(Math.random()*QUOTES.length)];
  document.getElementById('daily-quote').textContent = 'â€œ' + q + 'â€';
}
showRandomQuote();
document.getElementById('new-quote').addEventListener('click', showRandomQuote);

// è¾…åŠ©ï¼šæ¸²æŸ“æ¶ˆæ¯ï¼ˆåŒ…æ‹¬å¤´åƒæ°”æ³¡ï¼‰
function createAvatarSVG(){
  return `<svg viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg"><rect width="120" height="120" rx="60" fill="transparent"/><path d="M30 60c0-22 20-28 34-28s34 6 34 28v12c0 14-12 26-34 26s-34-12-34-26z" fill="#f7d9c9"/><circle cx="60" cy="60" r="26" fill="#ffeedf"/><ellipse cx="50" cy="62" rx="3" ry="2" fill="#2d2d2d"/><ellipse cx="70" cy="62" rx="3" ry="2" fill="#2d2d2d"/><path d="M50 72c4 4 16 4 20 0" stroke="#2d2d2d" stroke-width="2" fill="none" stroke-linecap="round"/></svg>`;
}

function appendMessage(text, who='bot', meta=null){
  const row = document.createElement('div');
  row.className = 'msg-row ' + (who==='user'? 'row-user':'row-bot');

  const avatar = document.createElement('div');
  avatar.className = 'avatar';
  avatar.innerHTML = createAvatarSVG();

  const msg = document.createElement('div');
  msg.className = 'msg ' + (who==='user'? 'user':'bot');
  msg.innerHTML = text.replace(/\n/g,'<br>');

  if(who==='user'){
    // ç”¨æˆ·åœ¨å³ä¾§
    row.appendChild(msg);
    row.appendChild(avatar);
  }else{
    row.appendChild(avatar);
    row.appendChild(msg);
  }

  chat.appendChild(row);
  if(meta){
    const m = document.createElement('div'); m.className='meta'; m.textContent = meta; chat.appendChild(m);
  }
  chat.scrollTop = chat.scrollHeight;
}

// æ˜¾ç¤º typing
function addTyping(){
  const row = document.createElement('div');
  row.className='msg-row';
  row.id = 'typing-row';
  const avatar = document.createElement('div'); avatar.className='avatar'; avatar.innerHTML = createAvatarSVG();
  const typing = document.createElement('div'); typing.className='msg bot typing-wrapper'; typing.innerHTML = `<div class='typing'><span class='dot'></span><span class='dot'></span><span class='dot'></span></div>`;
  row.appendChild(avatar); row.appendChild(typing);
  chat.appendChild(row);
  chat.scrollTop = chat.scrollHeight;
}
function removeTyping(){ const t = document.getElementById('typing-row'); if(t) t.remove(); }

// é”®ç›˜å›è½¦ä¸æŒ‰é’®
input.addEventListener('keydown', (e)=>{ if(e.key === 'Enter'){ e.preventDefault(); sendMessage(); } });
sendBtn.addEventListener('click', sendMessage);

// chip ç‚¹å‡»
Array.from(document.querySelectorAll('.chip')).forEach(c=>{ c.addEventListener('click', ()=>{ input.value = c.textContent; sendMessage(); }); });

// å‘é€ä¸»æµç¨‹
let inFlight = false;
async function sendMessage(){
  const text = input.value.trim();
  if(!text || inFlight) return;
  inFlight = true;
  appendMessage(text, 'user');
  input.value = '';

  addTyping();

  // å°è¯•è¯·æ±‚åç«¯ API
  try{
    const resp = await fetch('/api/advice', {
      method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({message:text})
    });

    if(!resp.ok) throw new Error('åç«¯è¿”å›é”™è¯¯');
    const data = await resp.json();
    removeTyping();
    appendMessage(data.reply || 'æŠ±æ­‰ï¼Œæœªæ”¶åˆ°æœ‰æ•ˆå›ç­”ã€‚', 'bot', 'æ¥è‡ªæ¨¡å‹');
  }catch(err){
    // åç«¯ä¸å¯ç”¨ -> ä½¿ç”¨å‰ç«¯è§„åˆ™å¼•æ“å…œåº•
    removeTyping();
    const fallback = generateFallbackAdvice(text);
    appendMessage(fallback, 'bot', 'ç¦»çº¿å»ºè®®ï¼ˆæœ¬åœ°è§„åˆ™ï¼‰');
  }

  inFlight = false;
}

// ç®€å•çš„å‰ç«¯è§„åˆ™å»ºè®®ï¼ˆå…³é”®å­—åŒ¹é…ï¼‰
function generateFallbackAdvice(text){
  text = text.replace(/\s+/g,'');
  const pairs = [
    {k:["ç†¬å¤œ","å‡Œæ™¨"], v:"å°½é‡å°†å°±å¯æ—¶é—´æå‰åˆ°23:00å‰ï¼Œå»ºç«‹ç¡å‰æ”¾æ¾ä»ªå¼ï¼ˆæ‰‹æœºé™éŸ³ã€æ¸©æ°´æ´—è„¸ã€æ·±å‘¼å¸ï¼‰ã€‚è‹¥é•¿æœŸå¤±çœ å»ºè®®å°±åŒ»å¹¶è€ƒè™‘è®¤çŸ¥è¡Œä¸ºç–—æ³•ã€‚"},
    {k:["æŠ½çƒŸ","é¦™çƒŸ","çƒŸç˜¾"], v:"å»ºè®®é€æ­¥å‡å°‘å¸çƒŸé‡å¹¶åˆ¶å®šæˆ’çƒŸè®¡åˆ’ï¼›å¯ä»¥å¯»æ±‚åŒ»ç”Ÿå¸®åŠ©æˆ–ä½¿ç”¨å°¼å¤ä¸æ›¿ä»£ç–—æ³•ï¼Œå¢åŠ ä½“è‚²æ´»åŠ¨ä»¥ç¼“è§£æˆ’æ–­ç—‡çŠ¶ã€‚"},
    {k:["å–é…’","é…—é…’"], v:"æ§åˆ¶é¥®é…’é¢‘ç‡å’Œé‡ï¼šç”·æ€§æ¯æ—¥ä¸è¶…è¿‡2ä¸ªæ ‡å‡†æ¯ã€å¥³æ€§ä¸è¶…è¿‡1ä¸ªï¼›é¿å…ç©ºè…¹é¥®é…’å¹¶æ³¨æ„å¿ƒç†ç–å¯¼ã€‚"},
    {k:["ä¹…å","åä¹…","ä¹…ç«™"], v:"æ¯å·¥ä½œ45-60åˆ†é’Ÿèµ·èº«æ´»åŠ¨5-10åˆ†é’Ÿï¼Œåšç®€å•ä¼¸å±•æˆ–çŸ­æ­¥è¡Œï¼›ä¿æŒæ­£ç¡®åå§¿ä¸è…°èƒŒæ”¯æ’‘ã€‚"},
    {k:["å¤±çœ ","ç¡ä¸å¥½"], v:"ä¿æŒå›ºå®šä½œæ¯ã€å‡å°‘æ™šé—´å’–å•¡å› æ‘„å…¥ã€ç¡å‰é¿å…å¼ºå…‰åˆºæ¿€ï¼›å¦‚é•¿æœŸä¸¥é‡å»ºè®®å°±è¯Šã€‚"},
    {k:["èƒƒèƒ€","æ¶ˆåŒ–ä¸è‰¯","é¥­åä¸èˆ’æœ"], v:"è¿›é£Ÿæ…¢ã€å°‘é£Ÿå¤šé¤ï¼Œé¿å…è¿‡æ²¹è…»å’Œè¾›è¾£åˆºæ¿€ï¼›é¤åé€‚åº¦æ•£æ­¥å¸®åŠ©æ¶ˆåŒ–ï¼Œå¿…è¦æ—¶å°±åŒ»æ£€æŸ¥ã€‚"},
  ];

  for(const p of pairs){
    for(const k of p.k){ if(text.indexOf(k) !== -1) return p.v; }
  }

  // é€šç”¨å»ºè®®
  return "å»ºè®®ï¼šè§„å¾‹ä½œæ¯ã€å‡è¡¡é¥®é£Ÿã€æ¯å‘¨è‡³å°‘150åˆ†é’Ÿä¸­ç­‰å¼ºåº¦è¿åŠ¨ï¼ˆæˆ–75åˆ†é’Ÿé«˜å¼ºåº¦ï¼‰ã€ä¿æŒè‰¯å¥½ç¤¾äº¤ä¸å¿ƒç†çŠ¶æ€ã€‚å¦‚ç—‡çŠ¶ä¸¥é‡æˆ–æŒç»­ï¼Œè¯·åŠæ—¶å°±åŒ»ã€‚";
}

// For demo: auto greet
appendMessage('ä½ å¥½ï¼Œæˆ‘æ˜¯å…»ç”Ÿå°åŠ©æ‰‹ã€‚ä½ å¯ä»¥è¾“å…¥å¥åº·é—®é¢˜æˆ–ä¸è‰¯ç”Ÿæ´»ä¹ æƒ¯ï¼Œæˆ‘ä¼šç»™å‡ºå»ºè®®ã€‚', 'bot', 'ç¤ºä¾‹');

</script>
</body>
</html>
